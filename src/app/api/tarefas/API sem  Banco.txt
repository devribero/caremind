// src/app/api/tarefas/route.ts

import { NextResponse } from 'next/server';

// Nosso "banco de dados" simulado continua o mesmo
const bancoDeDadosSimulado = [
  { id: 1, texto: "Estudar Next.js com App Router", concluida: true },
  { id: 2, texto: "Criar a API com Route Handlers", concluida: false },
];

// Função para o método GET
export async function GET(request: Request) {
  // No App Router, retornamos a resposta usando NextResponse.json()
  return NextResponse.json(bancoDeDadosSimulado);
}

// Função para o método POST
export async function POST(request: Request) {
  // Para pegar os dados enviados, usamos o método .json() do request
  const dados = await request.json();
  const textoDaTarefa = dados.texto;

  if (!textoDaTarefa) {
    return NextResponse.json({ erro: "O campo 'texto' é obrigatório." }, { status: 400 });
  }

  const novaTarefa = {
    id: Date.now(),
    texto: textoDaTarefa,
    concluida: false
  };

  bancoDeDadosSimulado.push(novaTarefa);

  // Retornamos a resposta com o status 201 (Created)
  return NextResponse.json(novaTarefa, { status: 201 });
}